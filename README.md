# MLOps HW1

Сервис для инференса обученной модели CatBoost — предсказываем вероятность фрода по транзакциям. 

## Общий пайплайн работы
- берёт `test.csv` из папки `input/`
- прогоняет препроцессинг
- запускает модель
- кладёт результаты в `output/`

> Варнинг: `train.csv` не для обучения. Он нужен как reference — чтобы выровнять колонки `test.csv` под те, на которых училась модель. Переобучения в контейнере нет, берём готовые веса `models/my_catboost.cbm`. 

## Файлы и структура проекта

1. **app/app.py** — главный скрипт, точка входа. Запускает всё: сначала препроцессинг, потом скоринг.  
2. **src/preprocessing.py** — читает `input/test.csv`, выравнивает колонки под `train.csv`, чистит данные и возвращает готовый датафрейм для модели.  
3. **src/scorer.py** — загружает обученную модель `my_catboost.cbm`, делает предсказания, сохраняет три файла:  
   - `sample_submission.csv` — итоговые предсказания  
   - `feature_importances.json` — топ-5 фичей по важности  
   - `score_distribution.png` — график распределения вероятностей  
4. **models/my_catboost.cbm** — готовые веса CatBoost, обученная модель.  
5. **train_data/train.csv** — нужен только как reference, чтобы знать порядок и набор колонок, не используется для обучения.  
6. **input/test.csv** — входной файл, который модель будет предсказывать.  
7. **output/** — папка, куда сервис сохраняет все результаты.  
8. **requirements.txt** — зависимости Python, которые ставятся внутри контейнера.  
9. **Dockerfile** — инструкция, как собрать и запустить Docker-контейнер.  
10. **README.md** — описание проекта и инструкции по запуску.

---

## Команды для сборки и запуска контейнера

```bash
# Сборка Docker образа
docker build -t fraud_service .

# Запуск контейнера
docker run --rm -v ${PWD}/input:/app/input -v ${PWD}/output:/app/output fraud_service


